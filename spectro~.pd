#N canvas 995 366 578 257 10;
#X declare -lib Gem;
#N canvas 273 171 722 804 show 0;
#X obj 393 203 sel 1 0;
#X obj 144 245 rotateXYZ 0 0 -90;
#X obj 322 457 loadbang;
#X obj 392 88 inlet;
#X obj 155 162 tabreceive~ \$0-fft;
#X obj 144 266 scaleXYZ -4 4 1;
#N canvas 1478 262 432 407 map2color 0;
#X obj 50 70 inlet~;
#X obj 50 303 outlet~;
#X obj 131 303 outlet~;
#X obj 216 303 outlet~;
#X obj 50 282 clip~ 0 1;
#X obj 131 282 clip~ 0 1;
#X obj 216 282 clip~ 0 1;
#X obj 216 191 *~ 1.8;
#X obj 216 170 pow~ 1.4;
#X obj 131 175 -~ 0.2;
#X obj 286 241 clip~ 0.5 1;
#X obj 286 261 -~ 0.5;
#X obj 131 229 *~ 1.2;
#X obj 50 175 -~ 0.56;
#X obj 50 198 *~ 2;
#X obj 50 221 pow~ 0.6;
#X obj 286 280 *~ -0.3;
#N canvas 92 117 450 300 shape_pow 0;
#X obj 54 99 inlet~;
#X obj 54 167 /~;
#X obj 92 148 abs~;
#X obj 54 233 outlet~;
#X obj 54 191 *~;
#X obj 190 169 inlet~;
#X obj 190 51 loadbang;
#X obj 190 75 f \$1;
#X obj 190 112 sel 0;
#X obj 190 141 f 1;
#X obj 92 172 pow~;
#X connect 0 0 1 0;
#X connect 0 0 2 0;
#X connect 1 0 4 0;
#X connect 2 0 1 1;
#X connect 2 0 10 0;
#X connect 4 0 3 0;
#X connect 5 0 10 1;
#X connect 6 0 7 0;
#X connect 7 0 8 0;
#X connect 8 0 9 0;
#X connect 8 1 5 0;
#X connect 9 0 5 0;
#X connect 10 0 4 1;
#X restore 50 129 pd shape_pow;
#X obj 117 71 loadbang;
#X msg 117 92 0.21;
#X connect 0 0 17 0;
#X connect 4 0 1 0;
#X connect 5 0 2 0;
#X connect 6 0 3 0;
#X connect 7 0 6 0;
#X connect 8 0 7 0;
#X connect 9 0 12 0;
#X connect 10 0 11 0;
#X connect 11 0 16 0;
#X connect 12 0 5 0;
#X connect 13 0 14 0;
#X connect 14 0 10 0;
#X connect 14 0 15 0;
#X connect 15 0 4 0;
#X connect 16 0 3 0;
#X connect 17 0 9 0;
#X connect 17 0 8 0;
#X connect 17 0 13 0;
#X connect 18 0 19 0;
#X connect 19 0 17 1;
#X restore 155 183 pd map2color;
#X obj 392 347 route 0;
#X obj 392 389 unpack;
#X obj 249 445 / 1024;
#X obj 322 499 samplerate~;
#X obj 144 467 scale 4;
#X obj 81 631 makefilename %.1f;
#X msg 81 652 text \$1\\\ Hz;
#X obj 322 478 bng 16 250 50 0 empty empty empty 0 -8 0 10 #fcfcfc #000000 #000000;
#X obj 229 466 - 0.5;
#X obj 229 487 * -2;
#X obj 425 431 / 1024;
#X obj 144 321 square 1;
#X obj 144 141 translateXYZ 0 0 -4;
#X obj 143 39 tgl 16 0 empty empty empty 0 -8 0 10 #fcfcfc #000000 #000000 0 1;
#X obj 472 430 == 0;
#X obj 472 409 route 0;
#X obj 392 368 route motion button;
#X obj 144 288 pix_texture \; quality 1;
#X obj 54 145 pix_texture \; quality 1;
#X obj 54 177 rectangle 4 4;
#X obj 587 290 unpack;
#X obj 604 450 /;
#X obj 604 471 * 4;
#X obj 392 327 route mouse dimen;
#X obj 495 515 / 2;
#X obj 450 515 / 2048;
#X obj 361 676 * 2;
#X obj 425 410 - 2;
#X obj 243 358 / 1024;
#X obj 243 380 * 2;
#X obj 243 402 - 1;
#X obj 242 422 *;
#X obj 331 600 pow -1;
#X obj 331 629 * 12;
#X obj 144 508 t a a;
#X obj 171 568 separator;
#X obj 144 488 translateXYZ;
#X obj 61 568 translateXYZ;
#X obj 171 738 rectangle 8 0.001 \; draw fill;
#X obj 379 575 t f f;
#X obj 392 630 pow -1;
#X obj 399 603 - 0.5;
#X obj 577 311 t a a;
#X obj 634 312 t a a a a;
#X obj 229 508 +;
#X obj 330 649 + 1;
#X obj 320 668 * -1;
#X obj 171 716 translateXYZ;
#X obj 303 54 tgl 16 0 empty empty empty 0 -8 0 10 #fcfcfc #000000 #000000 0 1;
#X obj 304 190 rectangle 4 4;
#X obj 303 75 gemhead 18 \; 0;
#X obj 303 107 alpha 1;
#X obj 303 128 color 1 0.8 0.8 0.1;
#X msg 192 651 14;
#X obj 171 588 alpha 1;
#X obj 171 609 color 1 1 1 0.4;
#X obj 61 609 color 1 1 1 1;
#X obj 61 588 alpha 1;
#X obj 606 673 gemkeyboard;
#X obj 606 694 sel 256;
#X obj 604 738 outlet;
#X msg 606 715 0;
#X obj 102 538 separator;
#X text 473 643 yeah \, documentation would be nice.;
#X obj 61 673 text2d \  \; justify right bottom;
#X msg 392 225 title spectro~ \, FSAA 2 \, dimen 1024 1024 \, create \, 1, f 38;
#X msg 411 280 0 \, destroy;
#X obj 392 305 gemwin 50;
#X obj 533 529 t f f;
#X obj 533 550 > 0;
#X obj 533 571 &&;
#X obj 560 551 <;
#X obj 533 594 change;
#X floatatom 533 615 5 0 0 0 - - - 0;
#X obj 171 547 spigot;
#X obj 144 75 gemhead 10;
#X obj 54 87 gemhead 12;
#X obj 144 404 gemhead 20;
#X obj 425 535 scale_log 1 1;
#X text 473 663 and less spaghetti.;
#X obj 541 159 block~ 2048 2 1;
#X obj 144 108 gemframebuffer \; dimen 2048 2048;
#X obj 144 212 pix_sig2pix~ 2048 512 \; mode waterfall;
#X obj 392 159 route float pause;
#X obj 441 179 == 0;
#X obj 303 33 == 0;
#X connect 0 0 72 0;
#X connect 0 1 73 0;
#X connect 1 0 5 0;
#X connect 2 0 14 0;
#X connect 3 0 90 0;
#X connect 4 0 6 0;
#X connect 5 0 24 0;
#X connect 6 0 89 0;
#X connect 6 1 89 1;
#X connect 6 2 89 2;
#X connect 7 0 23 0;
#X connect 8 0 35 0;
#X connect 8 0 75 0;
#X connect 8 1 34 0;
#X connect 9 0 15 0;
#X connect 10 0 31 0;
#X connect 10 0 32 0;
#X connect 11 0 43 0;
#X connect 12 0 13 0;
#X connect 13 0 71 0;
#X connect 14 0 10 0;
#X connect 14 0 60 0;
#X connect 15 0 16 0;
#X connect 16 0 51 0;
#X connect 17 0 85 0;
#X connect 19 0 89 0;
#X connect 20 0 82 0;
#X connect 20 0 92 0;
#X connect 21 0 20 0;
#X connect 22 0 21 0;
#X connect 23 0 8 0;
#X connect 23 1 22 0;
#X connect 24 0 18 0;
#X connect 25 0 26 0;
#X connect 27 0 49 0;
#X connect 27 0 78 1;
#X connect 27 1 50 0;
#X connect 28 0 29 0;
#X connect 28 0 38 1;
#X connect 28 0 33 0;
#X connect 29 0 26 1;
#X connect 29 0 56 1;
#X connect 30 0 7 0;
#X connect 30 1 27 0;
#X connect 31 0 85 2;
#X connect 32 0 85 1;
#X connect 33 0 45 1;
#X connect 34 0 17 0;
#X connect 34 0 9 0;
#X connect 35 0 36 0;
#X connect 36 0 37 0;
#X connect 37 0 38 0;
#X connect 38 0 44 1;
#X connect 39 0 40 0;
#X connect 39 0 45 2;
#X connect 40 0 51 1;
#X connect 40 0 52 0;
#X connect 41 0 69 0;
#X connect 41 1 81 0;
#X connect 42 0 61 0;
#X connect 43 0 41 0;
#X connect 44 0 64 0;
#X connect 46 0 39 0;
#X connect 46 1 48 0;
#X connect 47 0 52 1;
#X connect 48 0 47 0;
#X connect 49 0 35 1;
#X connect 49 1 28 0;
#X connect 50 0 9 1;
#X connect 50 1 17 1;
#X connect 50 2 46 0;
#X connect 50 3 28 1;
#X connect 51 0 43 2;
#X connect 52 0 53 0;
#X connect 53 0 54 2;
#X connect 54 0 45 0;
#X connect 55 0 57 0;
#X connect 57 0 58 0;
#X connect 58 0 59 0;
#X connect 59 0 56 0;
#X connect 60 0 71 1;
#X connect 61 0 62 0;
#X connect 62 0 54 0;
#X connect 63 0 71 0;
#X connect 64 0 63 0;
#X connect 65 0 66 0;
#X connect 66 0 68 0;
#X connect 68 0 67 0;
#X connect 69 0 44 0;
#X connect 72 0 74 0;
#X connect 73 0 74 0;
#X connect 74 0 30 0;
#X connect 75 0 76 0;
#X connect 75 1 78 0;
#X connect 76 0 77 0;
#X connect 77 0 79 0;
#X connect 78 0 77 1;
#X connect 79 0 80 0;
#X connect 79 0 81 1;
#X connect 81 0 42 0;
#X connect 82 0 88 0;
#X connect 83 0 25 0;
#X connect 84 0 11 0;
#X connect 85 0 12 0;
#X connect 88 0 19 0;
#X connect 88 1 25 1;
#X connect 89 0 1 0;
#X connect 90 0 0 0;
#X connect 90 1 91 0;
#X connect 91 0 20 0;
#X connect 92 0 55 0;
#X restore 270 126 pd show;
#X obj 200 104 tgl 16 0 \$0-tgl-s \$0-tgl-r empty 0 -8 0 10 #e5f0ff #000000 #000000 0 1;
#N canvas 510 445 790 571 fft 0;
#X obj 63 168 rfft~;
#X obj 63 195 pow~ 2;
#X obj 113 195 pow~ 2;
#X obj 63 58 inlet~;
#X obj 549 249 until;
#X obj 577 270 + 1;
#X obj 549 198 loadbang;
#X obj 549 291 t a a;
#X obj 549 333 * 3.14159;
#X obj 549 374 cos;
#X obj 548 478 tabwrite \$0-hanning;
#X obj 548 416 + 0.5;
#X obj 549 354 * 2;
#X obj 549 395 / -2;
#X obj 78 87 tabreceive~ \$0-hanning;
#X obj 63 108 *~;
#X obj 63 264 clip~ 0 1;
#X obj 326 58 bang~;
#X obj 326 130 until;
#X obj 326 84 t b b;
#X obj 371 109 f 0;
#X obj 326 151 f;
#X obj 353 151 + 1;
#X obj 63 285 tabsend~ \$0-fft-raw;
#X obj 304 503 tabwrite \$0-fft;
#X obj 233 255 -;
#X obj 304 473 /;
#X obj 303 430 f;
#X obj 303 451 array sum \$0-fft-raw;
#X obj 551 95 array define \$0-fft 2048;
#X obj 233 188 + 1;
#X text 607 267 create hanning window;
#X text 122 387 sum and avg of bins for log;
#X obj 63 243 sqrt~;
#X obj 231 335 f;
#X obj 304 389 i;
#X obj 341 389 i;
#X obj 549 270 f;
#X obj 326 172 t a a a;
#X obj 303 409 t b a;
#X msg 594 246 0;
#X text 587 441 FIXME: why?;
#X obj 231 356 tabread4 \$0-fft-raw;
#X obj 234 302 sel 0;
#X obj 233 279 i;
#X obj 548 442 pow 4;
#X obj 551 137 array define \$0-hanning 8192;
#X msg 549 228 8192;
#X obj 549 312 / 8192;
#X obj 326 109 f 2048;
#X obj 551 116 array define \$0-fft-raw 8182;
#X obj 345 214 / 2048;
#X obj 233 209 / 2048;
#X obj 63 138 /~ 1024;
#X obj 551 54 block~ 8192 8 1;
#N canvas 121 146 496 457 scale_log 0;
#X obj 43 55 inlet;
#X obj 44 358 outlet;
#X text 42 415 source: https://stackoverflow.com/a/63158920;
#X obj 62 175 log;
#X obj 62 94 loadbang;
#X obj 62 118 t b b;
#X obj 99 175 log;
#X obj 44 307 exp;
#X obj 44 238 *;
#X obj 62 209 -;
#X obj 44 262 +;
#X obj 62 151 f 4096;
#X obj 99 151 f 4;
#X connect 0 0 8 0;
#X connect 3 0 9 0;
#X connect 4 0 5 0;
#X connect 5 0 11 0;
#X connect 5 1 12 0;
#X connect 6 0 9 1;
#X connect 6 0 10 1;
#X connect 7 0 1 0;
#X connect 8 0 10 0;
#X connect 9 0 8 1;
#X connect 10 0 7 0;
#X connect 11 0 3 0;
#X connect 12 0 6 0;
#X restore 233 230 pd scale_log;
#N canvas 121 146 496 457 scale_log 0;
#X obj 43 55 inlet;
#X obj 44 358 outlet;
#X text 42 415 source: https://stackoverflow.com/a/63158920;
#X obj 62 175 log;
#X obj 62 94 loadbang;
#X obj 62 118 t b b;
#X obj 99 175 log;
#X obj 44 307 exp;
#X obj 44 238 *;
#X obj 62 209 -;
#X obj 44 262 +;
#X obj 99 151 f 4;
#X obj 62 151 f 4096;
#X connect 0 0 8 0;
#X connect 3 0 9 0;
#X connect 4 0 5 0;
#X connect 5 0 12 0;
#X connect 5 1 11 0;
#X connect 6 0 9 1;
#X connect 6 0 10 1;
#X connect 7 0 1 0;
#X connect 8 0 10 0;
#X connect 9 0 8 1;
#X connect 10 0 7 0;
#X connect 11 0 6 0;
#X connect 12 0 3 0;
#X restore 345 236 pd scale_log;
#X connect 0 0 1 0;
#X connect 0 1 2 0;
#X connect 1 0 33 0;
#X connect 2 0 33 0;
#X connect 3 0 15 0;
#X connect 4 0 37 0;
#X connect 5 0 37 1;
#X connect 6 0 47 0;
#X connect 7 0 48 0;
#X connect 7 1 10 1;
#X connect 8 0 12 0;
#X connect 9 0 13 0;
#X connect 11 0 45 0;
#X connect 12 0 9 0;
#X connect 13 0 11 0;
#X connect 14 0 15 1;
#X connect 15 0 53 0;
#X connect 16 0 23 0;
#X connect 17 0 19 0;
#X connect 18 0 21 0;
#X connect 19 0 49 0;
#X connect 19 1 20 0;
#X connect 20 0 21 1;
#X connect 21 0 22 0;
#X connect 21 0 38 0;
#X connect 22 0 21 1;
#X connect 25 0 44 0;
#X connect 26 0 24 0;
#X connect 27 0 28 0;
#X connect 28 0 26 0;
#X connect 30 0 52 0;
#X connect 33 0 16 0;
#X connect 34 0 42 0;
#X connect 35 0 39 0;
#X connect 36 0 27 1;
#X connect 37 0 5 0;
#X connect 37 0 7 0;
#X connect 38 0 30 0;
#X connect 38 1 51 0;
#X connect 38 2 24 1;
#X connect 39 0 27 0;
#X connect 39 1 26 1;
#X connect 39 1 28 1;
#X connect 40 0 37 1;
#X connect 42 0 24 0;
#X connect 43 0 34 0;
#X connect 43 1 35 0;
#X connect 44 0 43 0;
#X connect 45 0 10 0;
#X connect 47 0 4 0;
#X connect 48 0 8 0;
#X connect 49 0 18 0;
#X connect 51 0 56 0;
#X connect 52 0 55 0;
#X connect 53 0 0 0;
#X connect 55 0 25 0;
#X connect 56 0 25 1;
#X connect 56 0 34 1;
#X connect 56 0 36 0;
#X restore 269 73 pd fft;
#X obj 260 47 inlet~;
#X obj 260 183 outlet~;
#X obj 270 104 r \$0-tgl-s;
#X obj 270 147 s \$0-tgl-r;
#X text 422 191 Ben Wesch \, 2025;
#X obj 399 47 declare -lib Gem;
#X connect 0 0 6 0;
#X connect 3 0 2 0;
#X connect 3 0 4 0;
#X connect 3 1 0 0;
#X connect 5 0 0 0;
#X coords 0 -1 1 1 120 24 1 100 100;
